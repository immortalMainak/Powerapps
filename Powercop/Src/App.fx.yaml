App As appinfo:
    BackEnabled: =false
    OnStart: |-
        =Concurrent(
            Set(varUserEmailLower, Lower(User().Email)), Set(varUserName, User().FullName),
            Set(varTypeOfRequest, Blank()),
            Set(varItemId, Param("itemid")),
            Set(varNavigated, false),
            Set(varCodeReviewPercentThreshold, LookUp('Environment Variable Values', 'Environment Variable Definition'.'Display Name' = "MinAcceptablePercentageCodeReview").Value),
            Set(varCodeReviewAppUrl, LookUp('Environment Variable Values', 'Environment Variable Definition'.'Display Name' = "CodeReviewAppUrl").Value),
            Set(varCodeReviewQueryString, LookUp('Environment Variable Values', 'Environment Variable Definition'.'Display Name' = "ReviewScreenQueryString").Value),
            Set(varMainAppUrl, LookUp('Environment Variable Values', 'Environment Variable Definition'.'Display Name' = "MainAppUrl").Value)
        );
        Set(varIsCoE, !IsBlank(LookUp('COE Approvers', Email = varUserEmailLower)));
        ClearCollect(colNavItems,
            Table({Title: "Home", Icon: Icon.Home, Index: 1, Screen: Blank(), HasAccess: true, 
                    ShowInNavigation: true, Url: varMainAppUrl},
                {Title: "New App Request", Index: 2, Icon: Icon.Add, Screen: 'App Request Screen', HasAccess: true,
                    ShowInNavigation: true, Url: ""},
                {Title: "CoE Approval", Icon: Icon.DockCheckProperties, Index: 3, Screen: Blank(),
                    HasAccess: varIsCoE, ShowInNavigation: true, Url: varMainAppUrl & "&screen=coe"},
                {Title: "My App Requests", Icon: Icon.DocumentWithContent, Index: 4, Screen: 'My App Requests Screen',
                    HasAccess: true, ShowInNavigation: true, Url: ""},
                {Title: "Code Review", Icon: Icon.Tools, Index: 5, Screen: Blank(), HasAccess: true,
                    ShowInNavigation: true, Url: varCodeReviewAppUrl},
                {Title: "All Apps", Icon: Icon.Items, Index: 6, Screen: 'All Apps Screen', HasAccess: varIsCoE,
                    ShowInNavigation: true, Url: ""}
            )
        );
    SizeBreakpoints: =[600, 900, 1200, 1400, 1600, 1800]
    StartScreen: =Switch(Lower(Param("screen")), "req", 'App Request Screen', "mreq", 'My App Requests Screen', "allapps", 'All Apps Screen', 'My App Requests Screen')
    Theme: =PowerAppsTheme

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

